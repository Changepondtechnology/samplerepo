name: Enforce Commit Message

on:
  pull_request:
    types: [opened, synchronize]

jobs:
  enforce-commit-message:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@v2

      - name: Verify commit messages
        run: |
          COMMIT_MESSAGES=$(git log --format=%B ${{ github.event.before }}..${{ github.event.after }})
          MIN_LENGTH=15  # Adjust the minimum length as needed
          for COMMIT_MESSAGE in $COMMIT_MESSAGES; do
            COMMIT_MESSAGE_LENGTH=${#COMMIT_MESSAGE}
            if [[ -z "$COMMIT_MESSAGE" ]]; then
              echo "Error: Commit message cannot be empty."
              exit 1
            elif (( COMMIT_MESSAGE_LENGTH < MIN_LENGTH )); then
              echo "Error: Commit message must have at least $MIN_LENGTH characters."
              exit 1
            fi
          done
